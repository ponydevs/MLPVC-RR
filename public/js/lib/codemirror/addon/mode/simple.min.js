"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(m){function S(e,t){if(!e.hasOwnProperty(t))throw new Error("Undefined state "+t+" in simple mode")}function d(e,t){if(!e)return/(?:)/;var n="";return e instanceof RegExp?(e.ignoreCase&&(n="i"),e=e.source):e=String(e),new RegExp((!1===t?"":"^")+"(?:"+e+")",n)}function y(e,t){(e.next||e.push)&&S(t,e.next||e.push),this.regex=d(e.regex),this.token=function(e){if(!e)return null;if(e.apply)return e;if("string"==typeof e)return e.replace(/\./g," ");for(var t=[],n=0;n<e.length;n++)t.push(e[n]&&e[n].replace(/\./g," "));return t}(e.token),this.data=e}function s(e,t){if(e===t)return!0;if(!e||"object"!=(void 0===e?"undefined":_typeof(e))||!t||"object"!=(void 0===t?"undefined":_typeof(t)))return!1;var n=0;for(var o in e)if(e.hasOwnProperty(o)){if(!t.hasOwnProperty(o)||!s(e[o],t[o]))return!1;n++}for(var o in t)t.hasOwnProperty(o)&&n--;return 0==n}function v(e,t,n,o){var a;if(n.persistent)for(var r=t.persistentStates;r&&!a;r=r.next)(n.spec?s(n.spec,r.spec):n.mode==r.mode)&&(a=r);var i=a?a.mode:n.mode||m.getMode(e,n.spec),l=a?a.state:m.startState(i);n.persistent&&!a&&(t.persistentStates={mode:i,spec:n.spec,state:l,next:t.persistentStates}),t.localState=l,t.local={mode:i,end:n.end&&d(n.end),endScan:n.end&&!1!==n.forceEnd&&d(n.end,!1),endToken:o&&o.join?o[o.length-1]:o}}m.defineSimpleMode=function(e,t){m.defineMode(e,function(e){return m.simpleMode(e,t)})},m.simpleMode=function(e,t){S(t,"start");var n={},o=t.meta||{},a=!1;for(var r in t)if(r!=o&&t.hasOwnProperty(r))for(var i=n[r]=[],l=t[r],d=0;d<l.length;d++){var s=l[d];i.push(new y(s,t)),(s.indent||s.dedent)&&(a=!0)}var c,f,p,u,h={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:a?[]:null}},copyState:function(e){var t={state:e.state,pending:e.pending,local:e.local,localState:null,indent:e.indent&&e.indent.slice(0)};e.localState&&(t.localState=m.copyState(e.local.mode,e.localState)),e.stack&&(t.stack=e.stack.slice(0));for(var n=e.persistentStates;n;n=n.next)t.persistentStates={mode:n.mode,spec:n.spec,state:n.state==e.localState?t.localState:m.copyState(n.mode,n.state),next:t.persistentStates};return t},token:(p=n,u=e,function(e,t){if(t.pending){var n=t.pending.shift();return 0==t.pending.length&&(t.pending=null),e.pos+=n.text.length,n.token}if(t.local){if(t.local.end&&e.match(t.local.end)){var o=t.local.endToken||null;return t.local=t.localState=null,o}var a,o=t.local.mode.token(e,t.localState);return t.local.endScan&&(a=t.local.endScan.exec(e.current()))&&(e.pos=e.start+a.index),o}for(var r=p[t.state],i=0;i<r.length;i++){var l=r[i],d=(!l.data.sol||e.sol())&&e.match(l.regex);if(d){l.data.next?t.state=l.data.next:l.data.push?((t.stack||(t.stack=[])).push(t.state),t.state=l.data.push):l.data.pop&&t.stack&&t.stack.length&&(t.state=t.stack.pop()),l.data.mode&&v(u,t,l.data.mode,l.token),l.data.indent&&t.indent.push(e.indentation()+u.indentUnit),l.data.dedent&&t.indent.pop();var s=l.token;if(s&&s.apply&&(s=s(d)),2<d.length&&l.token&&"string"!=typeof l.token){t.pending=[];for(var c=2;c<d.length;c++)d[c]&&t.pending.push({text:d[c],token:l.token[c-1]});return e.backUp(d[0].length-(d[1]?d[1].length:0)),s[0]}return s&&s.join?s[0]:s}}return e.next(),null}),innerMode:function(e){return e.local&&{mode:e.local.mode,state:e.localState}},indent:(c=n,f=o,function(e,t,n){if(e.local&&e.local.mode.indent)return e.local.mode.indent(e.localState,t,n);if(null==e.indent||e.local||f.dontIndentStates&&-1<function(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return!0}(e.state,f.dontIndentStates))return m.Pass;var o=e.indent.length-1,a=c[e.state];e:for(;;){for(var r=0;r<a.length;r++){var i=a[r];if(i.data.dedent&&!1!==i.data.dedentIfLineStart){var l=i.regex.exec(t);if(l&&l[0]){o--,(i.next||i.push)&&(a=c[i.next||i.push]),t=t.slice(l[0].length);continue e}}}break}return o<0?0:e.indent[o]})};if(o)for(var g in o)o.hasOwnProperty(g)&&(h[g]=o[g]);return h}});