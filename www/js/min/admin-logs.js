"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};DocReady.push(function(){var e=!1,t=$("#filter-form");t.on("submit",function(e){e.preventDefault();var n=t.find('[name="type"] option:selected'),i=n.val(),s=t.find('[name="by"]').val().trim(),a=""+(i.length?n.text().replace("of type ","")+" entries":"")+(s.length?(i.length?"":"entries")+" by "+s:""),l=!!a.length&&t.serialize();t.find("button[type=reset]").attr("disabled",l===!1),l!==!1?$.Dialog.wait("Navigation","Looking for "+a.replace(/</g,"&lt;")):$.Dialog.success("Navigation","Search terms cleared"),$.toPage.call({query:l},window.location.pathname.replace(/\d+($|\?)/,"1$1"),!0,!0,!1,function(){return l!==!1?/^Page \d+/.test(document.title)?a+" - "+document.title:document.title.replace(/^.*( - Page \d+)/,a+"$1"):document.title.replace(/^.* - (Page \d+)/,"$1")})}).on("reset",function(e){e.preventDefault(),t.find('[name="type"]').val(""),t.find('[name="by"]').val(""),t.triggerHandler("submit")});var n=$("#logs");n.find("tbody").off("page-switch").on("page-switch",function(){$(this).children().each(function(){var n=$(this);n.find(".expand-section").off("click").on("click",function(){var t=$(this),i="Log entry details";if(t.hasClass("typcn-minus"))t.toggleClass("typcn-minus typcn-plus").next().stop().slideUp();else if(1===t.next().length)t.toggleClass("typcn-minus typcn-plus").next().stop().slideDown();else{var s=function(){if(e)return{v:!1};e=!0,t.removeClass("typcn-minus typcn-plus").addClass("typcn-refresh");var s=parseInt(n.children().first().text()),a=function(){t.addClass("typcn-times color-red").css("cursor","not-allowed").off("click")};$.post("/admin/logs/details/"+s,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(i,this.message),a();var e=$.mk("div").attr("class","expandable-section").css("display","none");$.each(this.details,function(t,n){var i=void 0,s=$.mk("strong").text(n[0]+": ");i=null===n[1]?$.mk("em").addClass("color-darkblue").text("empty"):"boolean"==typeof n[1]?$.mk("span").addClass("color-"+(n[1]?"green":"red")).text(n[1]?"yes":"no"):n[1],e.append($.mk("div").append(s,i))}),e.insertAfter(t).slideDown(),Time.Update(),t.addClass("typcn-minus color-darkblue")})).always(function(){e=!1,t.removeClass("typcn-refresh")}).fail(a)}();if("object"===("undefined"==typeof s?"undefined":_typeof(s)))return s.v}}),n.find(".server-init").off("click").on("click",function(){t.find('[name="by"]').val($(this).text().trim()),t.triggerHandler("submit")})})}).trigger("page-switch").on("click",".dynt-el",function(){var e=$w.width();if(e>=650)return!0;var t=$(this),n=t.parent(),i=n.parent(),s=i.children(".ip");s.children("a").length&&(s=s.clone(!0,!0),s.children(".self").html(function(){return $(this).text()}));var a=s.contents(),l=$.mk("span").attr("class","modal-ip").append("<br><b>Initiator:</b> ",a.eq(0));a.length>1&&l.append("<br><b>IP Address:</b> "+a.get(2).textContent),$.Dialog.info("Hidden details of entry #"+i.children(".entryid").text(),$.mk("div").append("<b>Timestamp:</b> "+n.children("time").html().trim().replace(/<br>/," "),l))});var i=[{className:"darkblue",showins:!0,showdel:!0,title:"diff"},{className:"green",showins:!0,showdel:!1,title:"new"},{className:"red",showins:!1,showdel:!0,title:"old"}];n.on("click contextmenu",".btn.view-switch",function(e){var t="contextmenu"===e.type;if(t&&e.shiftKey)return!0;e.preventDefault();for(var n=$(e.target),s=n.next(),a=n.attr("class").match(/\b(darkblue|green|red)\b/)[1],l=void 0,o=0;o<i.length;o++)i[o].className===a&&(l=i[o+(t?-1:1)]);"undefined"==typeof l&&(l=i[t?i.length-1:0]),s.find("ins")[l.showins?"show":"hide"](),s.find("del")[l.showdel?"show":"hide"](),s[l.showins&&l.showdel?"removeClass":"addClass"]("no-colors"),s[0===s.contents().filter(function(){return!/^(del|ins)$/.test(this.nodeName.toLowerCase())||"none"!==this.style.display}).length?"addClass":"removeClass"]("empty"),n.removeClass(a).addClass(l.className).text(l.title)})});
//# sourceMappingURL=/js/min/admin-logs.js.map
