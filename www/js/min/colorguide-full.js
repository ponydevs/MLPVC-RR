"use strict";$(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$content.find("img[data-src]"),a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=e.eq(a);if(0!==r.length){var i=r.attr("data-src"),l=new Image;l.src=i,$(l).on("load",function(){r.css("opacity",0).attr("src",i).removeAttr("data-src").animate({opacity:1},300),t(e,a+1)})}else $.callCallback(n)}var e=$("#sort-by"),a=$("#full-list"),n=$("#guide-reorder"),r=$("#guide-reorder-cancel"),i=a.find("section > ul"),l=window.EQG?"?eqg":"";e.on("change",function(){var t=e.data("baseurl"),r=e.val(),l=(t+"?ajax&"+r).replace(/&$/,""),o=(t+"?"+r).replace(/\?$/,"");$.Dialog.wait("Changing sort order"),$.get(l,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);a.html(this.html),i=a.find("section > ul"),window._cgFullListOnScroll(),n.attr("disabled",Boolean(r.length)),history.replaceState(history.state,"",o),$.Dialog.close()}))}),window._cgFullListOnScroll=$.throttle(100,function(){0!==i.length&&i.each(function(){var e=$(this);e.isInViewport()&&t(e.find("img[data-src]"),0,function(){e.addClass("loaded"),i=a.find("section > ul:not(.loaded)")})})}),$w.on("scroll",window._cgFullListOnScroll),$w.triggerHandler("scroll"),"function"==typeof window.Sortable&&(a.on("click",".sort-alpha",function(){var t=$(this).closest("section").children("ul");t.children().sort(function(t,e){return $(t).text().trim().localeCompare($(e).text().trim())}).appendTo(t)}),n.on("click",function(){if(n.hasClass("typcn-tick")){$.Dialog.wait("Re-ordering appearances");var t=[];a.children().children("ul").children().each(function(){t.push($(this).children().attr("data-href").split("/").pop().replace(/^(\d+)\D.*$/,"$1"))}),$.post("/cg/full/reorder"+l,{list:t.join(",")},$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);a.removeClass("sorting").html(this.html),i=a.find("section > ul"),$w.triggerHandler("scroll"),n.removeClass("typcn-tick green").addClass("typcn-arrow-unsorted darkblue").html("Re-order"),r.addClass("hidden"),$.Dialog.close()}))}else n.removeClass("typcn-arrow-unsorted darkblue").addClass("typcn-tick green").html("Save"),a.addClass("sorting").children().each(function(){var t=$(this).children("ul");t.children().each(function(){var t=$(this);t.data("orig-index",t.index())}).children().moveAttr("href","data-href"),t.data("sortable-instance",new Sortable(t.get(0),{ghostClass:"moving",animation:300}))}),$(".sort-alpha").show(),r.removeClass("hidden")}),r.on("click",function(){n.removeClass("typcn-tick green").addClass("typcn-arrow-unsorted darkblue").html("Re-order"),a.removeClass("sorting").children().each(function(){var t=$(this).children("ul");t.children().sort(function(t,e){return t=$(t).data("orig-index"),e=$(e).data("orig-index"),t>e?1:t<e?-1:0}).appendTo(t).removeData("orig-index").children().moveAttr("data-href","href"),t.data("sortable-instance").destroy(),t.removeData("sortable-instance")}),$(".sort-alpha").hide(),r.addClass("hidden")}))},function(){$w.off("scroll",window._cgFullListOnScroll)});
//# sourceMappingURL=/js/min/colorguide-full.js.map
