"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,a,o){return a&&t(e.prototype,a),o&&t(e,o),e}}();!function(t){var e="pony-color-palette",a={},o=function(){function e(a,o,r){var l=this;_classCallCheck(this,e),this.appearanceId=a,this.shown=!1,this.colorData=null,this.getColorData(),this.$picker=t.mk("div").attr("class","hidden pony-color-palette").appendTo($body),this.$swatchBox=t.mk("div").attr("class","swatchbox loading").appendTo(this.$picker),this.$nullColor=t.mk("li").attr("class","color color-null selected").append(t.mk("span").attr("title","Default").text(o)),t.mk("ul").attr("class","colorgroup").append(this.$nullColor).appendTo(this.$swatchBox),this.$picker.on("click",".color",function(e){e.stopPropagation();var a=t(e.target).closest(".color"),o=a.children().text();l.$picker.find(".color.selected").removeClass("selected"),a.addClass("selected"),r(o.length>0?o:null),l.hide(!0)})}return _createClass(e,[{key:"displayError",value:function(e){this.$swatchBox.html(t.mk("p").attr("class","error").text(e))}},{key:"getColorData",value:function(){var e=this;void 0===a[this.appearanceId]?(a[this.appearanceId]=[this],t.post("/cg/colorgroup/list/"+this.appearanceId+"?hex",t.mkAjaxHandler(function(o){if(!o.status)return e.displayError(o.message);t.each(a[e.appearanceId],function(t,e){e.fillSwatchBox(o.list)})}))):a[this.appearanceId].push(this)}},{key:"fillSwatchBox",value:function(e){var a=this;this.$swatchBox.removeClass("loading").children().first().nextAll().remove(),t.each(e,function(e,o){var r=t.mk("ul").attr("class","colorgroup").appendTo(a.$swatchBox);r.append(t.mk("li").attr({title:o.label,class:"color group-icon"})),t.each(o.colors,function(e,a){r.append(t.mk("li").attr("class","color").append(t.mk("span").attr("title",a.label).css("background-color",a.hex).text(a.hex)))})})}},{key:"display",value:function(e){t(".pony-color-palette").addClass("hidden");var a=t(e.target),o=a.offset(),r=o.top,l=o.left;return r+=a.outerHeight(),this.$picker.css({top:r,left:l}).removeClass("hidden"),this}},{key:"hide",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this.$picker.is(":hover")?(this.$picker.addClass("hidden"),this):this}},{key:"selectColor",value:function(e){this.$picker.find(".color").removeClass("selected").filter(function(){return t(this).text()===e}).addClass("selected")}}]),e}();t.fn.ponyColorPalette=function(a,r,l){return this.each(function(){var n=t(this);n.data(e,new o(a,r,function(t){l(n,t)})),n.on("focus",function(a){t(a.target).data(e).display(a)}),n.on("keydown",function(a){t.isKey(Key.Escape,a)&&(a.preventDefault(),t(a.target).data(e).hide())}),n.on("blur",function(a){t(a.target).data(e).hide()})}),this}}(jQuery);
//# sourceMappingURL=/js/min/jquery.ponycolorpalette.js.map
