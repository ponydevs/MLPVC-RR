{"version":3,"sources":["jquery.uploadzone.js"],"names":["defaults","requestKey","title","accept","target","helper","$","fn","uploadZone","opt","extend","$this","this","first","$input","document","createElement","attr","type","name","$helper","addClass","on","e","stopPropagation","preventDefault","console","log","files","originalEvent","dataTransfer","File","fd","FormData","append","getCSRFToken","ajaxOpts","url","contentType","processData","cache","data","success","window","trigger","status","removeClass","removeAttr","val","Dialog","close","children","fadeTo","path","fail","message","error","xhr","xhrobj","ajaxSettings","upload","addEventListener","event","lengthComputable","complete","loaded","position","total","Math","round","ajax","jQuery"],"mappings":"CACA,WACC,GAAIA,IACHC,WAAY,OACZC,MAAO,eACPC,OAAQ,UACRC,OAAQ,GACRC,QAAQ,EAGTC,GAAEC,GAAGC,WAAa,SAASC,GAC1BA,EAAMH,EAAEI,QAAO,KAAQV,EAASS,EAEhC,IAAIP,GAAQO,EAAIP,MACfS,EAAQL,EAAEM,MAAMC,QAChBC,EAASR,EAAES,SAASC,cAAc,UAAUC,MAC3CC,KAAQ,OACRC,KAAQV,EAAIR,WACZE,OAAUM,EAAIN,QAGhB,IAAIM,EAAIJ,OAAQ,GAAIe,GAAUd,EAAES,SAASC,cAAc,QAAQK,SAAS,SA0ExE,OAxEAP,GAAOQ,GAAG,sBAAsB,SAASC,GACxCA,EAAEC,kBACFD,EAAEE,iBAEFd,EAAiB,cAAXY,EAAEL,KAAuB,WAAa,eAAe,UAE5DJ,EAAOQ,GAAG,cAAc,SAASC,GAChCG,QAAQC,IAAIJ,EACZ,IAAIK,GAAQL,EAAEnB,OAAOwB,OAASL,EAAEM,cAAcC,aAAaF,KAE3D,IAAwB,mBAAbA,GAAM,MAAwBA,EAAM,YAAcG,OAC5D,OAAO,CAER,IAAIC,GAAK,GAAIC,SACbD,GAAGE,OAAO,SAAUN,EAAM,IAC1BI,EAAGE,OAAO,aAAc5B,EAAE6B,gBAE1BxB,EAAMU,SAAS,YACf,IAAIe,IACHC,IAAK5B,EAAIL,OACTc,KAAM,OACNoB,aAAa,EACbC,aAAa,EACbC,OAAO,EACPC,KAAMT,EACNU,QAAS,SAAUD,GAClB,MAAoB,gBAATA,GAA0Bf,QAAQC,IAAIc,KAAUnC,EAAEqC,QAAQC,QAAQ,kBAEzEH,EAAKI,QACRlC,EAAMmC,YAAY,aAClB1B,EAAQ2B,WAAW,iBACnBjC,EAAOkC,IAAI,IACX1C,EAAE2C,OAAOC,MAAM,WACdvC,EAAMwC,SAAS,OAAOC,OAAO,IAAI,EAAE,WAClC,GAAIzC,GAAQL,EAAEM,KACdD,GAAMM,KAAK,MAAMwB,EAAKY,MAAM/B,GAAG,OAAO,WACrCX,EAAMyC,OAAO,IAAI,WAMpBzC,EAAMmC,YAAY,aAClB1B,EAAQ2B,WAAW,iBACnBjC,EAAOkC,IAAI,IACX1C,EAAE2C,OAAOK,KAAKpD,EAAMuC,EAAKc,YAG3BC,MAAO,SAASC,GACI,MAAfA,EAAIZ,QAAiC,MAAfY,EAAIZ,QAC9BvC,EAAE2C,OAAOK,KAAKpD,EAAM,uBAAuBuD,EAAIZ,OAAO,MAGpDpC,GAAIJ,SAAQ+B,EAAc,IAAI,WACjC,GAAIsB,GAASpD,EAAEqD,aAAaF,KAU5B,OATIC,GAAOE,QACVF,EAAOE,OAAOC,iBAAiB,WAAY,SAAUC,GACpD,IAAKA,EAAMC,iBAAkB,OAAO,CAEpC,IAAIC,GAAWF,EAAMG,QAAUH,EAAMI,SACpCC,EAAQL,EAAMK,KACf/C,GAAQH,KAAK,gBAAiBmD,KAAKC,MAAML,EAAWG,EAAQ,QAC1D,GAEGT,IAERpD,EAAEgE,KAAKlC,KAGRzB,EAAMuB,OAAOpB,GACTL,EAAIJ,QAAQM,EAAMuB,OAAOd,GAEtBT,IAEN4D","file":"jquery.uploadzone.min.js","sourcesContent":["/* Image upload plugin w/ drag'n'drop support | by @DJDavid98 | for gh:ponydevs/MLPVC-RR */\r\n(function(){\r\n\tvar defaults = {\r\n\t\trequestKey: 'file',\r\n\t\ttitle: 'Image upload',\r\n\t\taccept: 'image/*',\r\n\t\ttarget: '',\r\n\t\thelper: true,\r\n\t};\r\n\r\n\t$.fn.uploadZone = function(opt){\r\n\t\topt = $.extend(true,{},defaults,opt);\r\n\r\n\t\tvar title = opt.title,\r\n\t\t\t$this = $(this).first(),\r\n\t\t\t$input = $(document.createElement('input')).attr({\r\n\t\t\t\t'type': 'file',\r\n\t\t\t\t'name': opt.requestKey,\r\n\t\t\t\t'accept': opt.accept,\r\n\t\t\t});\r\n\r\n\t\tif (opt.helper) var $helper = $(document.createElement('div')).addClass('helper');\r\n\r\n\t\t$input.on('dragenter dragleave',function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\t$this[e.type === 'dragenter' ? 'addClass' : 'removeClass']('drop');\r\n\t\t});\r\n\t\t$input.on('change drop',function(e){\r\n\t\t\tconsole.log(e);\r\n\t\t\tvar files = e.target.files || e.originalEvent.dataTransfer.files;\r\n\r\n\t\t\tif (typeof files[0] === 'undefined' || !(files[0] instanceof File))\r\n\t\t\t\treturn true;\r\n\r\n\t\t\tvar fd = new FormData();\r\n\t\t\tfd.append('sprite', files[0]);\r\n\t\t\tfd.append('CSRF_TOKEN', $.getCSRFToken());\r\n\r\n\t\t\t$this.addClass('uploading');\r\n\t\t\tvar ajaxOpts = {\r\n\t\t\t\turl: opt.target,\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tcontentType: false,\r\n\t\t\t\tprocessData: false,\r\n\t\t\t\tcache: false,\r\n\t\t\t\tdata: fd,\r\n\t\t\t\tsuccess: function (data) {\r\n\t\t\t\t\tif (typeof data === 'string') return console.log(data) === $(window).trigger('ajaxerror');\r\n\r\n\t\t\t\t\tif (data.status){\r\n\t\t\t\t\t\t$this.removeClass('uploading');\r\n\t\t\t\t\t\t$helper.removeAttr('data-progress');\r\n\t\t\t\t\t\t$input.val('');\r\n\t\t\t\t\t\t$.Dialog.close(function(){\r\n\t\t\t\t\t\t\t$this.children('img').fadeTo(200,0,function(){\r\n\t\t\t\t\t\t\t\tvar $this = $(this);\r\n\t\t\t\t\t\t\t\t$this.attr('src',data.path).on('load',function(){\r\n\t\t\t\t\t\t\t\t\t$this.fadeTo(200,1);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t$this.removeClass('uploading');\r\n\t\t\t\t\t\t$helper.removeAttr('data-progress');\r\n\t\t\t\t\t\t$input.val('');\r\n\t\t\t\t\t\t$.Dialog.fail(title,data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(xhr){\r\n\t\t\t\t\tif (xhr.status === 500 || xhr.status === 401) return;\r\n\t\t\t\t\t$.Dialog.fail(title,'Upload failed (HTTP '+xhr.status+')');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif (opt.helper) ajaxOpts['xhr'] = function () {\r\n\t\t\t\tvar xhrobj = $.ajaxSettings.xhr();\r\n\t\t\t\tif (xhrobj.upload)\r\n\t\t\t\t\txhrobj.upload.addEventListener('progress', function (event) {\r\n\t\t\t\t\t\tif (!event.lengthComputable) return true;\r\n\r\n\t\t\t\t\t\tvar complete = event.loaded || event.position,\r\n\t\t\t\t\t\t\ttotal = event.total;\r\n\t\t\t\t\t\t$helper.attr('data-progress', Math.round(complete / total * 100));\r\n\t\t\t\t\t}, false);\r\n\r\n\t\t\t\treturn xhrobj;\r\n\t\t\t};\r\n\t\t\t$.ajax(ajaxOpts);\r\n\t\t});\r\n\r\n\t\t$this.append($input);\r\n\t\tif (opt.helper) $this.append($helper);\r\n\r\n\t\treturn $this;\r\n\t};\r\n})(jQuery);"],"sourceRoot":"/source/"}