{"version":3,"sources":["global.js"],"names":["DocumentIsReady","$document","triggerHandler","window","DocReady","length","i","l","call","OpenSidebarByDefault","matchMedia","matches","$","mk","document","createElement","apply","arguments","urlToAbsolute","url","a","href","extend","$w","$body","body","$head","head","$header","$sbToggle","$main","$sidebar","$footer","$title","children","on","Dialog","fail","mkAjaxHandler","f","data","console","log","trigger","fn","mkData","obj","tempdata","this","serializeArray","each","el","name","value","getCSRFToken","n","cookie","match","Error","ajaxPrefilter","event","origEvent","type","toUpperCase","t","r","split","push","join","CSRF_TOKEN","ajaxSetup","statusCode",401,"undefined",404,500,"copy","text","queryCommandSupported","prompt","$helper","success","css","opacity","width","height","position","left","top","display","appendTo","focus","get","select","execCommand","e","setTimeout","remove","jQuery","pad","cdupdate","$cd","now","Date","airs","attr","diff","getTimeDiff","past","$oldcd","$nextime","parents","next","find","clearInterval","cdtimer","setCD","time","one","month","week","day","hour","minute","second","createTimeStr","OAUTH_URL","consent","localStorage","getItem","$this","opener","sure","setItem","wait","location","confirm","title","post","status","message","HandleNav","close","months","$uc","first","addClass","setInterval","$calendar","d","getMonth","getDate","updateTimesF","DocReadyOnce","LinkClick","which","link","hostname","REWRITE_REGEX","test","pathname","preventDefault","callback","xhr","abort","ajax","via-js","responseURL","js","content","sidebar","footer","pagetitle","avatar","empty","doreload","reload","src","pos","indexOf","splice","LoadCSS","item","html","$headerNav","append","clone","history","LoadJS","removeClass","requrl","dataType","off","hasClass","substring","openSidebar","state","originalEvent"],"mappings":"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","file":"global.min.js","sourcesContent":["(function($){\r\n\t// document.createElement shortcut\r\n\t$.mk = function(){ return $(document.createElement.apply(document,arguments)) };\r\n\r\n\t// Convert relative URL to absolute\r\n\t$.urlToAbsolute = function(url){\r\n\t\tvar a = $.mk('a');\r\n\t\ta.href = url;\r\n\t\treturn a.href;\r\n\t};\r\n\r\n\t// Globalie zcoomon elements\r\n\t$.extend(window, {\r\n\t\t$w: $(window),\r\n\t\t$document: $(document),\r\n\t\t$body: $(document.body),\r\n\t\t$head: $(document.head),\r\n\t\t$header: $('header'),\r\n\t\t$sbToggle: $('.sidebar-toggle'),\r\n\t\t$main: $('#main'),\r\n\t\t$sidebar: $('#sidebar'),\r\n\t\t$footer: $('footer'),\r\n\t});\r\n\twindow.$title = $head.children('title');\r\n\r\n\t// Create AJAX response handling function\r\n\t$w.on('ajaxerror',function(){\r\n\t\t$.Dialog.fail(false,'There was an error while processing your request. You may find additional details in the browser\\'s console.');\r\n\t});\r\n\t$.mkAjaxHandler = function(f){\r\n\t\treturn function(data){\r\n\t\t\tif (typeof data !== 'object'){\r\n\t\t\t\tconsole.log(data);\r\n\t\t\t\t$w.trigger('ajaxerror');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof f === 'function') f.call(data);\r\n\t\t};\r\n\t};\r\n\r\n\t// Convert .serializeArray() result to object\r\n\t$.fn.mkData = function(obj){\r\n\t\tvar tempdata = $(this).serializeArray(), data = {};\r\n\t\t$.each(tempdata,function(i,el){\r\n\t\t\tdata[el.name] = el.value;\r\n\t\t});\r\n\t\tif (typeof obj === 'object')\r\n\t\t\t$.extend(data, obj);\r\n\t\treturn data;\r\n\t};\r\n\r\n\t// Get CSRF token from cookies\r\n\t$.getCSRFToken = function(){\r\n\t\tvar n = document.cookie.match(/CSRF_TOKEN=([a-z\\d]+)/i);\r\n\t\tif (n && n.length)\r\n\t\t\treturn n[1];\r\n\t\telse throw new Error('Missing CSRF_TOKEN');\r\n\t};\r\n\t$.ajaxPrefilter(function(event, origEvent){\r\n\t\tif ((origEvent.type||event.type).toUpperCase() !== 'POST')\r\n\t\t\treturn;\r\n\r\n\t\tvar t = $.getCSRFToken();\r\n\t\tif (typeof event.data === \"undefined\")\r\n\t\t\tevent.data = \"\";\r\n\t\tif (typeof event.data === \"string\"){\r\n\t\t\tvar r = event.data.length > 0 ? event.data.split(\"&\") : [];\r\n\t\t\tr.push(\"CSRF_TOKEN=\" + t);\r\n\t\t\tevent.data = r.join(\"&\");\r\n\t\t}\r\n\t\telse event.data.CSRF_TOKEN = t;\r\n\t});\r\n\t$.ajaxSetup({\r\n\t\tstatusCode: {\r\n\t\t\t401: function(){\r\n\t\t\t\t$.Dialog.fail(undefined, \"Cross-site Request Forgery attack detected. Please notify the site administartors.\");\r\n\t\t\t},\r\n\t\t\t404: function(){\r\n\t\t\t\t$.Dialog.fail(undefined, \"Error 404: The requested endpoint could not be found\");\r\n\t\t\t},\r\n\t\t\t500: function(){\r\n\t\t\t\t$.Dialog.fail(false, 'The request failed due to an internal server error. If this persists, please open an issue on GitHub using the link in the footer!');\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t// Copy any text to clipboard\r\n\t// Must be called from within an event handler\r\n\t$.copy = function(text){\r\n\t\tif (!document.queryCommandSupported('copy')){\r\n\t\t\tprompt('Copy with Ctrl+C, close with Enter', text);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tvar $helper = $.mk('textarea'),\r\n\t\t\tsuccess = false;\r\n\t\t$helper\r\n\t\t\t.css({\r\n\t\t\t\topacity: 0,\r\n\t\t\t\twidth: 0,\r\n\t\t\t\theight: 0,\r\n\t\t\t\tposition: 'fixed',\r\n\t\t\t\tleft: '-10px',\r\n\t\t\t\ttop: '50%',\r\n\t\t\t\tdisplay: 'block',\r\n\t\t\t})\r\n\t\t\t.text(text)\r\n\t\t\t.appendTo('body')\r\n\t\t\t.focus();\r\n\t\t$helper.get(0).select();\r\n\r\n\t\ttry {\r\n\t\t\tsuccess = document.execCommand('copy');\r\n\t\t} catch(e){}\r\n\r\n\t\tif (!success)\r\n\t\t\t$.Dialog.fail('Copy to clipboard', 'Copying text to clipboard failed!');\r\n\t\tsetTimeout(function(){\r\n\t\t\t$helper.remove();\r\n\t\t}, 1);\r\n\t};\r\n})(jQuery);\r\n\r\nDocReady.push(function Global(){\r\n\t// Sign in button handler\r\n\tvar OAUTH_URL = window.OAUTH_URL,\r\n\t\tconsent = localStorage.getItem('cookie_consent');\r\n\r\n\t$('#signin').on('click',function(){\r\n\t\tvar $this = $(this),\r\n\t\t\topener = function(sure){\r\n\t\t\t\tif (!sure) return;\r\n\r\n\t\t\t\tlocalStorage.setItem('cookie_consent',1);\r\n\t\t\t\t$this.attr('disabled', true);\r\n\t\t\t\t$.Dialog.wait('Sign-in process', 'Redirecting you to DeviantArt', function(){\r\n\t\t\t\t\twindow.location.href = OAUTH_URL;\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\tif (consent == undefined) $.Dialog.confirm('EU Cookie Policy Notice','In compliance with the <a href=\"http://ec.europa.eu/ipg/basics/legal/cookies/index_en.htm\">EU Cookie Policy</a> we must inform you that our website will store cookies on your device to remember your logged in status between browser sessions.<br><br>If you would like to avoid these completly harmless pieces of information required to use this website, click \"Decline\" and continue browsing as a guest.<br><br>This warning will not appear again if you accept our use of persistent cookies.',['Accept','Decline'],opener);\r\n\t\telse opener(true);\r\n\t});\r\n\r\n\t// Sign out button handler\r\n\t$('#signout').on('click',function(){\r\n\t\tvar title = 'Sign out';\r\n\t\t$.Dialog.confirm(title,'Are you sure you want to sign out?',function(sure){\r\n\t\t\tif (!sure) return;\r\n\r\n\t\t\t$.Dialog.wait(title,'Signing out');\r\n\r\n\t\t\t$.post('/signout',$.mkAjaxHandler(function(){\r\n\t\t\t\tif (this.status){\r\n\t\t\t\t\t$.Dialog.success(title,this.message);\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tHandleNav(location.href, function(){\r\n\t\t\t\t\t\t\t$.Dialog.close();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},1000);\r\n\t\t\t\t}\r\n\t\t\t\telse $.Dialog.fail(title,this.message);\r\n\t\t\t}));\r\n\t\t});\r\n\t});\r\n\r\n\t// Countdown\r\n\tvar $cd, cdtimer,\r\n\t\tmonths = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n\twindow.setCD = function(){\r\n\t\tvar $uc = $('#upcoming');\r\n\t\tif ($uc.length === 0) return;\r\n\t\t$cd = $uc.find('li').first().find('time').addClass('nodt');\r\n\t\tcdtimer = setInterval(function(){\r\n\t\t\tcdupdate($cd);\r\n\t\t}, 1000);\r\n\t\tcdupdate($cd);\r\n\r\n\t\t$uc.find('li').each(function(){\r\n\t\t\tvar $this = $(this),\r\n\t\t\t\t$calendar = $this.children('.calendar'),\r\n\t\t\t\td = new Date($this.find('.countdown').data('airs') || $this.find('time').attr('datetime'));\r\n\t\t\t$calendar.children('.top').text(months[d.getMonth()]);\r\n\t\t\t$calendar.children('.bottom').text(d.getDate());\r\n\t\t});\r\n\t\twindow.updateTimesF();\r\n\t};\r\n\twindow.setCD();\r\n\tfunction pad(n){return n<10?'0'+n:n}\r\n\tfunction cdupdate($cd){\r\n\t\tvar now = new Date(),\r\n\t\t\tairs = new Date($cd.attr('datetime')),\r\n\t\t\tdiff = getTimeDiff(now, airs);\r\n\t\tif (diff.past === true || $cd.length === 0){\r\n\t\t\tif ($cd.length > 0){\r\n\t\t\t\tvar $oldcd = $cd,\r\n\t\t\t\t\t$nextime = $oldcd.parents('li').next().find('time');\r\n\t\t\t\t$oldcd.parents('li').remove();\r\n\t\t\t}\r\n\t\t\tclearInterval(cdtimer);\r\n\t\t\tif ($cd.length === 0 || $nextime.length === 0) return $('#upcoming').remove();\r\n\t\t\treturn window.setCD();\r\n\t\t}\r\n\t\tvar text = 'in ';\r\n\t\tif (diff.time < one.month){\r\n\t\t\tif (diff.week > 0)\r\n\t\t\t\tdiff.day += diff.week * 7;\r\n\t\t\tif (diff.day > 0)\r\n\t\t\t\ttext += diff.day+' day'+(diff.day!==1?'s':'')+' & ';\r\n\t\t\tif (diff.hour > 0)\r\n\t\t\t\ttext += diff.hour+':';\r\n\t\t\ttext += +pad(diff.minute)+':'+pad(diff.second);\r\n\t\t}\r\n\t\telse text = createTimeStr(now, airs);\r\n\t\t$cd.text(text);\r\n\t}\r\n\t$w.on('unload',function(){ clearInterval(cdtimer) });\r\n});\r\n\r\nfunction DocumentIsReady(){\r\n\t$document.triggerHandler('paginate-refresh');\r\n\tif (window.DocReady.length < 1) return;\r\n\tfor (var i = 0, l = window.DocReady.length; i<l; i++)\r\n\t\twindow.DocReady[i].call(window);\r\n}\r\nfunction OpenSidebarByDefault(){\r\n\treturn window.matchMedia('all and (min-width: 1200px)').matches;\r\n}\r\nvar DocReadyOnce = false;\r\n$(function(){\r\n\tif (DocReadyOnce) return;\r\n\tDocReadyOnce = true;\r\n\r\n\t// Sidebar toggle handler\r\n\tvar $body = $(document.body),\r\n\t\txhr = false;\r\n\t$sbToggle.off('click').on('click',function(e){\r\n\t\te.preventDefault();\r\n\r\n\t\tif (xhr !== false) return;\r\n\t\t$sbToggle.trigger('sb-'+($body.hasClass('sidebar-open')?'close':'open'));\r\n\t}).on('sb-open sb-close',function(e){\r\n\t\tvar close = e.type.substring(3) === 'close';\r\n\t\t$body[close ? 'removeClass' : 'addClass']('sidebar-open');\r\n\t\tlocalStorage[close ? 'setItem' : 'removeItem']('sidebar-closed', 'true');\r\n\t});\r\n\tvar openSidebar = localStorage.getItem('sidebar-closed') !== 'true';\r\n\tif (!OpenSidebarByDefault()) openSidebar = !openSidebar;\r\n\tif (openSidebar)\r\n\t\t$body.addClass('sidebar-open');\r\n\r\n\t// AJAX page loader\r\n\tvar REWRITE_REGEX = window.REWRITE_REGEX;\r\n\r\n\tfunction LinkClick(e){\r\n\t\tif (e.which > 2) return true;\r\n\r\n\t\tvar link = this;\r\n\t\tif (link.hostname !== location.hostname || !REWRITE_REGEX.test(link.pathname))\r\n\t\t\treturn true;\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tHandleNav(this.href);\r\n\t}\r\n\t$document.off('click','a[href]',LinkClick).on('click','a[href]',LinkClick);\r\n\r\n\t$w.off('popstate').on('popstate',function(e){\r\n\t\tvar state = e.originalEvent.state;\r\n\r\n\t\tif (!state['via-js'])\r\n\t\t\treturn $w.trigger('nav-popstate', [state]);\r\n\t\tHandleNav(location.pathname, state);\r\n\t});\r\n\r\n\tfunction HandleNav(url, callback){\r\n\t\tif (xhr !== false){\r\n\t\t\txhr.abort();\r\n\t\t\txhr = false;\r\n\t\t}\r\n\r\n\t\tvar title = 'Navigation';\r\n\t\t$body.addClass('loading');\r\n\t\txhr = $.ajax({\r\n\t\t\turl: url,\r\n\t\t\tdata: {'via-js': true},\r\n\t\t\tsuccess: $.mkAjaxHandler(function(){\r\n\t\t\t\tif (!this.status) $.Dialog.fail(title, this.message);\r\n\r\n\t\t\t\turl = this.responseURL;\r\n\t\t\t\t$w.triggerHandler('unload');\r\n\t\t\t\tif (!OpenSidebarByDefault())\r\n\t\t\t\t\t$sbToggle.trigger('sb-close');\r\n\r\n\t\t\t\tvar css = this.css,\r\n\t\t\t\t\tjs = this.js,\r\n\t\t\t\t\tcontent = this.content,\r\n\t\t\t\t\tsidebar = this.sidebar,\r\n\t\t\t\t\tfooter = this.footer,\r\n\t\t\t\t\tpagetitle = this.title,\r\n\t\t\t\t\tavatar = this.avatar;\r\n\r\n\t\t\t\t$main.empty();\r\n\t\t\t\tvar doreload = false,\r\n\t\t\t\t\treload = location.pathname === url;\r\n\t\t\t\t$body.children('script[src], script[data-src]').each(function(){\r\n\t\t\t\t\tvar $this = $(this),\r\n\t\t\t\t\t\tsrc = $this.attr('src') || $this.attr('data-src'),\r\n\t\t\t\t\t\tpos = js.indexOf(src);\r\n\r\n\t\t\t\t\tif (!reload && pos !== -1)\r\n\t\t\t\t\t\tjs.splice(pos, 1);\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (src.indexOf('global') !== -1){\r\n\t\t\t\t\t\t\tdoreload = true;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse $this.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (doreload) return window.location.pathname = url;\r\n\t\t\t\t$head.children('link[href], style[href]').each(function(){\r\n\t\t\t\t\tvar $this = $(this),\r\n\t\t\t\t\t\thref = $this.attr('href'),\r\n\t\t\t\t\t\tpos = css.indexOf(href);\r\n\r\n\t\t\t\t\tif (pos !== -1)\r\n\t\t\t\t\t\tcss.splice(pos, 1);\r\n\t\t\t\t\telse $this.remove();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t(function LoadCSS(item){\r\n\t\t\t\t\tif (item >= css.length){\r\n\t\t\t\t\t\t$main.addClass('pls-wait').html(content);\r\n\t\t\t\t\t\t$sidebar.html(sidebar);\r\n\t\t\t\t\t\t$footer.html(footer);\r\n\t\t\t\t\t\twindow.updateTimesF();\r\n\t\t\t\t\t\tvar $headerNav = $header.find('nav').children();\r\n\t\t\t\t\t\t$headerNav.children().first().children('img').attr('src', avatar);\r\n\t\t\t\t\t\t$headerNav.children(':not(:first-child)').remove();\r\n\t\t\t\t\t\t$headerNav.append($sidebar.find('nav').children().children().clone());\r\n\t\t\t\t\t\t$title.text(pagetitle);\r\n\r\n\t\t\t\t\t\thistory[location.pathname === url?'replaceState':'pushState']({'via-js':true},'',url);\r\n\r\n\t\t\t\t\t\twindow.DocReady = [];\r\n\r\n\t\t\t\t\t\treturn (function LoadJS(item){\r\n\t\t\t\t\t\t\tif (item >= js.length){\r\n\t\t\t\t\t\t\t\tDocumentIsReady();\r\n\t\t\t\t\t\t\t\t$body.removeClass('loading');\r\n\t\t\t\t\t\t\t\t$main.removeClass('pls-wait');\r\n\t\t\t\t\t\t\t\tif (typeof callback === 'function')\r\n\t\t\t\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t\t\t\t//noinspection JSUnusedAssignment\r\n\t\t\t\t\t\t\t\txhr = false;\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar requrl = js[item];\r\n\t\t\t\t\t\t\txhr = $.ajax({\r\n\t\t\t\t\t\t\t\turl: requrl,\r\n\t\t\t\t\t\t\t\tdataType: 'text',\r\n\t\t\t\t\t\t\t\tsuccess:function(data){\r\n\t\t\t\t\t\t\t\t\t$body.append($.mk('script').attr('data-src', requrl).text(data));\r\n\t\t\t\t\t\t\t\t\tLoadJS(item+1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})(0);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar requrl = css[item];\r\n\t\t\t\t\txhr = $.ajax({\r\n\t\t\t\t\t\turl: requrl,\r\n\t\t\t\t\t\tdataType: 'text',\r\n\t\t\t\t\t\tsuccess: function(data){\r\n\t\t\t\t\t\t\t$head.append($.mk('style').attr('href',requrl).text(data));\r\n\t\t\t\t\t\t\tLoadCSS(item+1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t})(0);\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\twindow.HandleNav = function(){ HandleNav.apply(window, arguments) };\r\n\r\n\tDocumentIsReady();\r\n});\r\n\r\n// Remove loading animation from header on load\r\n$w.on('load',function(){\r\n\t$body.removeClass('loading');\r\n});\r\n"],"sourceRoot":"/source/"}